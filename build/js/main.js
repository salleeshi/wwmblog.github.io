define("src/definition.js",[],function(require){$("body").on("click","dfn",function(){var $t=$(this);var def=$t.attr("title");var defClass=$t.attr("data-def");var $wrapper=$t.parent().parent();var $defContainer=defClass?$t.wrapper.find(defClass):null;if(!$defContainer||$defContainer.length==0){$defContainer=$wrapper.children(".definition")}if($defContainer.length==0){$defContainer=$('<div class="definition hidden"></div>').appendTo($wrapper)}var immDef=$defContainer.children().html();if(immDef!=def){$defContainer.removeClass("hidden").html("<span class='def-span'>"+def+"</span>").css("height",immDef==def?0:$defContainer.children().height())}else{$defContainer.html("<span class='def-span'>"+def+"<b></b></span>").css("height",0).addClass("hidden")}})});define("data/skill.js",[],{labels:["C++","创造力","Python","Tooling","问题解决","Flash","基本专业技能","Obj-C","Web","Happy Hacking"],shortLabels:["C++","创造力","Python","Tooling","问题解决","Flash","专业基础","Obj-C","Web","Hacking"],datasets:[{fill:"#e05146",fillOpacity:.4,stroke:"#e05146",strokeWidth:1,data:[null,{v:3,desc:"一般水平。虽然无法成为Creative Director，但还是能作为日常工作的buff。"},null,null,{v:3,desc:"我们能记忆的解决方案总是有限的。关键是知道解决拓展问题的方法。特别是有Search Engine的这个年代。"},null,{v:4,desc:"我不是大学量产的码农。我有足够的专业知识解决90%日常问题。"},null,null,{v:4,desc:"Hack everything that you want to improve."}]},{fill:"#0084ff",fillOpacity:.3,stroke:"#0084ff",strokeWidth:1,data:[{v:4,desc:"经验值为1.5年。用过Qt做过桌面应用和用Win32 API做过一个界面库。没有接触过微软的MFC。"},null,{v:1,desc:"学Python的动机一半是为了打发时间。最大的成果是写了个SublimeText的插件。"},{v:3,desc:"合适的工具来完成工作能有效提高工作效率。例如我使用SCSS来管理CSS。"},null,{v:4,desc:"虽然Flash是上一代技术，但是有时候仍能派上用场。而且往往重要的并非技术本身，而是这个技术带给我们的它自身以外的思考。"},null,{v:3,desc:"写过一些Obj-C的项目。它让我对编写面向用户的应用有了更深的了解。"},{v:4,desc:"是很有趣的平台。现在我是一个Full-Time Web开发者 (2012至今)。"},null]}]});define("src/misc.js",[],function(require,exports,module){var exps=module.exports={transitionEnd:"",animationEnd:"",threed:false,transition:false};var resizeDebounceTO=null;var RESIZE_THRESHOLD=250;$(window).on("resize",function(){function debounced(){$(window).trigger("debouncedResize")}if(resizeDebounceTO){clearTimeout(resizeDebounceTO)}else{debounced()}resizeDebounceTO=setTimeout(debounced,RESIZE_THRESHOLD)});var autoresize_els=[];$.fn.watchAutoResize=function(){if(this.data("_ar_width")!=undefined)return;this.data("_ar_width",this.width()).data("_ar_height",this.height());autoresize_els.push(this);if(autoresize_els.length==1){$(window).on("debouncedResize",function(){for(var i=0;i<autoresize_els.length;++i){var t=autoresize_els[i];var w=t.width();var h=t.height();if(w!=t.data("_ar_width")||h!=t.data("_ar_height")){t.data("_ar_width",w).data("_ar_height",h).trigger("autoresize")}}})}return this};$.fn.transform=function(value){var self=arguments.callee;if(!self.vendors){self.vendors=["webkitTransform","MozTransform","msTransform","OTransform","transform"]}var vendors=self.vendors;var ss=this[0].style;if(vendors.length){for(var i=0;i<vendors.length;++i){if(ss.hasOwnProperty(vendors[i])){self.vendors=vendors[i];break}}}if(value)ss[self.vendors]=value;return this};exps.transformCSS=function(value){var self=arguments.callee;if(!self.prefix){var vendors=["webkitTransform","MozTransform","msTransform","OTransform","transform"];var prefixes=["-webkit-transform","-moz-transform","-ms-transform","-o-transform","transform"];var ss=$("body")[0].style;for(var i=0;i<vendors.length;++i){if(ss.hasOwnProperty(vendors[i])){self.prefix=prefixes[i]}}if(!self.prefix){self.prefix="transform"}}return self.prefix+":"+value+";"};(function(){var threed="none";var el=document.createElement("div");var transforms={WebkitTransform:"-webkit-transform",OTransform:"-o-transform",MSTransform:"-ms-transform",MozTransform:"-moz-transform",Transform:"transform",transform:"transform"};document.body.insertBefore(el,document.body.lastChild);for(var t in transforms){if(el.style[t]!==undefined){el.style[t]="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)";threed=window.getComputedStyle(el).getPropertyValue(transforms[t])}}if(threed!==undefined){threed=threed!=="none"}exps.threed=threed;var p,pre=["","O","Webkit","Moz"];for(p in pre){if(el.style[pre[p]+"Transition"]!==undefined){exps.transition=true;break}}exps.transition=exps.transition||el.style["transition"]!=undefined;document.body.removeChild(el);var baseTREnd=" transitionEnd transitionend";var baseANIEnd=" animationEnd animationend";if($.browser.firefox){baseTREnd="mozTransitionEnd"+baseTREnd;baseANIEnd="mozAnimationEnd"+baseANIEnd}else if(window.opera){baseTREnd="oTransitionEnd otransitionend"+baseTREnd;baseANIEnd="oAnimationEnd oanimationend"+baseANIEnd}else{baseTREnd="webkitTransitionEnd"+baseTREnd;baseANIEnd="webkitAnimationEnd"+baseANIEnd}exps.transitionEnd=baseTREnd;exps.animationEnd=baseANIEnd})();(function(){var lastTime=0;var vendors=["webkit","moz"];for(var x=0;x<vendors.length&&!window.requestAnimationFrame;++x){window.requestAnimationFrame=window[vendors[x]+"RequestAnimationFrame"];window.cancelAnimationFrame=window[vendors[x]+"CancelAnimationFrame"]||window[vendors[x]+"CancelRequestAnimationFrame"]}if(!window.requestAnimationFrame)window.requestAnimationFrame=function(callback,element){var currTime=(new Date).getTime();var timeToCall=Math.max(0,16-(currTime-lastTime));var id=window.setTimeout(function(){callback(currTime+timeToCall)},timeToCall);lastTime=currTime+timeToCall;return id};if(!window.cancelAnimationFrame)window.cancelAnimationFrame=function(id){clearTimeout(id)}})();(function(){var EASING_FUNC={linear:function(t){return t},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return 1*((t=t/1-1)*t*t+1)},easeInOutCubic:function(t){if((t/=1/2)<1)return 1/2*t*t*t;return 1/2*((t-=2)*t*t+2)},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return-1*((t=t/1-1)*t*t*t-1)},easeInOutQuart:function(t){if((t/=1/2)<1)return 1/2*t*t*t*t;return-1/2*((t-=2)*t*t*t-2)},easeInExpo:function(t){return t==0?1:1*Math.pow(2,10*(t/1-1))},easeOutExpo:function(t){return t==1?1:1*(-Math.pow(2,-10*t/1)+1)},easeInOutExpo:function(t){if(t==0)return 0;if(t==1)return 1;if((t/=1/2)<1)return 1/2*Math.pow(2,10*(t-1));return 1/2*(-Math.pow(2,-10*--t)+2)}};$.genericAnimate=function(length,duration,easing,onFrame){if(typeof duration=="function"){onFrame=duration;easing="easeInOutCubic";duration=400}else if(typeof easing=="function"){onFrame=easing;if(typeof duration=="string"){easing=duration;duration=400}else{easing="easeInOutCubic"}}var startTime=Date.now();var doAni=function(){var time=Date.now();var frame=time-startTime;var p=EASING_FUNC[easing](frame/duration);if(frame>=duration){if(p>1){p=1}}onFrame(length*p,p);if(frame<duration){requestAnimationFrame(doAni)}};requestAnimationFrame(doAni)}})();exps.insertCSS=function($targetEl,stylesheet){if(!stylesheet){stylesheet=$targetEl;$targetEl=null}var isStyleTag=true;if(!$targetEl){$targetEl=$("<style type='text/css' />").appendTo("head")}else{isStyleTag=$targetEl.attr("tagName").toLowerCase()=="style"}return $targetEl.html(isStyleTag?stylesheet:"&shy;<style>"+stylesheet+"</style>")}});define("src/skill/sk-graph.js",["src/misc.js"],function(require,exports,module){module.exports=Graph;require("src/misc.js");function Graph(data,canvas){this.data=data;this.canvas=canvas;this.effect={fill:data.fill||"#000","fill-opacity":data.fillOpacity||1,stroke:data.stroke||"#000","stroke-width":data.strokeWidth||1};this.polygon=null;this.polygonMask=null;this.group=null;this.dots=[];this.dotData=[]}Graph.prototype.vertexSize=10/2;Graph.prototype.maskDotSize=14/2;Graph.prototype.draw=draw;Graph.prototype.init=init;Graph.prototype.animate=animate;Graph.prototype.updateMask=updateMask;Graph.prototype.getData=getData;Graph.prototype.getGroup=function(){return this.group};function init(force){if(this.polygon){if(force){this.polygonMask.remove();this.group.remove()}else{return}}this.dots=[];var canvas=this.canvas;var group=canvas.group();var ds=this.data.data;for(var i=0;i<ds.length;++i){if(ds[i]==null){continue}var dot=canvas.circle(0,0).center(0,0).data("idx",i);this.dots.push(dot);group.add(dot)}this.polygonMask=canvas.clip();this.polygon=canvas.polygon().clipWith(this.polygonMask).attr("pointer-events","none");this.group=group.add(this.polygon);this.canvas.moveToCenter(this.group)}function draw(){this.init(true);var maskDots=[];var canvas=this.canvas;var ds=this.data.data;var polygonString=[];for(var i=0,j=0;i<ds.length;++i){if(ds[i]==null){continue}var pos=canvas.vertexPosition(i,ds[i].v);maskDots.push(pos);polygonString.push(pos.x+","+pos.y);this.dots[j].attr({rx:this.vertexSize,ry:this.vertexSize}).center(pos.x,pos.y).fill(this.data.stroke||"#000");++j}this.polygon.attr("points",polygonString.join(" ")).attr(this.effect);this.updateMask(maskDots);return this}function animate(){this.init();this.dotData=[];this.polygon.attr(this.effect);var ds=this.data.data;for(var i=0,j=0;i<ds.length;++i){if(ds[i]==null){continue}this.dots[j].attr({rx:this.vertexSize,ry:this.vertexSize}).fill(this.data.stroke||"#000");var pos=this.canvas.vertexPosition(i,ds[i].v);this.dotData[j]={toX:pos.x,toY:pos.y,toDis:Math.sqrt(pos.x*pos.x+pos.y*pos.y)};++j}var DURATION=1500;var TO=this.canvas.vertexPosition(0);var DISTANCE=Math.sqrt(TO.x*TO.x+TO.y*TO.y);var self=this;$.genericAnimate(DISTANCE,DURATION,function(unit,p){var dots=self.dots;var maskdots=new Array(dots.length);var polygonString=new Array(dots.length);for(var i=0;i<dots.length;++i){var dot=dots[i];var data=self.dotData[i];var pp=unit/data.toDis;if(pp>1){pp=1}var toX=data.toX*pp;var toY=data.toY*pp;dot.center(toX,toY);maskdots[i]={x:toX,y:toY};polygonString[i]=toX+","+toY}self.updateMask(maskdots);self.polygon.attr("points",polygonString.join(" "))});return this}function updateMask(dots){var clippath=this.polygonMask.children()[0];if(clippath==undefined){clippath=this.canvas.path().attr("clip-rule","evenodd");this.polygonMask.add(clippath)}var minX=999999999;var minY=999999999;var maxX=-99999999;var maxY=-99999999;var path="";var vr=this.maskDotSize;for(var i=0;i<dots.length;++i){var dot=dots[i];path+=[" M",dot.x,dot.y,"m",-vr,0,"a",vr,vr,"0 1 0",vr*2,0,"a",vr,vr,"0 1 0",-vr*2,0,"z"].join(" ");if(dot.x<minX){minX=dot.x}if(dot.x>maxX){maxX=dot.x}if(dot.y<minY){minY=dot.y}if(dot.y>maxY){maxY=dot.y}}path=["M",minX-vr,minY-vr,"L",maxX+vr,minY-vr,maxX+vr,maxY+vr,minX-vr,maxY+vr,"Z"].join(" ")+path;clippath.attr("d",path)}function getData(element){var parent=element.parentNode||element.parentElement;if(parent!=this.group.node){return null}var idx=parseInt(element.getAttribute("data-idx"));if(!isNaN(idx)){var d=$.extend({},this.data.data[idx]);d["idx"]=idx;return d}return null}});define("src/skill/sk-chart.js",["src/skill/sk-graph.js"],function(require,exports,module){module.exports=RadarChart;var Graph=require("src/skill/sk-graph.js");function RadarChart(data,elementID){var canvas=SVG(elementID);canvas.elementID=elementID;canvas.data=data;canvas.unitAngle=360/data.labels.length;canvas.maxValue=5;canvas.firstRender=true;canvas.graphs=[];var datasets=data.datasets;for(var i=0;i<datasets.length;++i){canvas.graphs.push(new Graph(datasets[i],canvas))}canvas.render=render;canvas.renderBG=renderBG;canvas.renderGraphs=renderGraphs;canvas.moveToCenter=moveToCenter;canvas.vertexPosition=vertexPosition;canvas.setup=setup;canvas.getData=getData;canvas.EVT_RESIZE="resize";canvas.setup();canvas.renderBG();return canvas}function setup(){this.CENTER=document.getElementById(this.elementID).clientWidth/2;this.RADIUS=this.CENTER-50}function renderBG(){var group=this.group();var colors=["#e2ddce","#d8d1be","#d1c8b1","#cac1a9","#c5bca3"];var c_len=colors.length;var labels=this.data.labels;for(var i=0;i<c_len;++i){var string=[];for(var j=labels.length-1;j>=0;--j){var pos=this.vertexPosition(j,c_len-i);string.push(pos.x+","+pos.y)}group.add(this.polygon(string.join(" "),true).fill(colors[i]))}var labelStyle={size:"12px",anchor:"middle",fill:"#b4ac95"};var LABEL_LEN=labels.length;var LABEL_LEN_1_4=LABEL_LEN/4;var LABEL_LEN_2_4=LABEL_LEN/2;var LABEL_LEN_3_4=LABEL_LEN_1_4*3;for(i=0;i<labels.length;++i){var pos=this.vertexPosition(i,5.2);var text=this.text(labels[i]).font(labelStyle);var bbox=text.node.getBBox();if(i<LABEL_LEN_2_4&&i>0){pos.x+=bbox.width/2}else if(i!=0&&i!=LABEL_LEN_2_4){pos.x-=bbox.width/2}if(i<LABEL_LEN_3_4&&i>LABEL_LEN_1_4){pos.y+=bbox.height/2}else if(i!=LABEL_LEN_1_4&&i!=LABEL_LEN_3_4){pos.y-=bbox.height/2}text.center(pos.x,pos.y);group.add(text)}this.moveToCenter(group)}function renderGraphs(){for(var i=0;i<this.graphs.length;++i){var g=this.graphs[i];if(this.firstRender){g.animate()}else{g.draw()}}}function render(event){if(event==this.EVT_RESIZE){this.setup();this.clear();this.renderBG();if(this.firstRender==false){this.renderGraphs()}}else if(this.firstRender){this.renderGraphs();this.firstRender=false}}function moveToCenter(svgElement){svgElement.transform({x:this.CENTER,y:this.CENTER})}function vertexPosition(index,value){var a=90-this.unitAngle*index;var p=value==undefined?1:value/this.maxValue;var x=Math.floor(cos(a)*this.RADIUS*p);var y=-Math.floor(sin(a)*this.RADIUS*p);return{x:x,y:y}}function getData(vetexElement){for(var i=0;i<this.graphs.length;++i){var d=this.graphs[i].getData(vetexElement);if(d){d["name"]=this.data.labels[d.idx];return d}}return null}function cos(deg){return Math.cos(deg*Math.PI/180)}function sin(deg){return Math.sin(deg*Math.PI/180)}});define("src/event.js",[],function(require,exports){function EventTarget(){if(this==window){return new EventTarget}this.__handlers={};this.__handlersCount=0}EventTarget.prototype.on=function(event,handler){if(typeof event!="string"||typeof handler!="function"){return}var handlers=this.__handlers[event];if(!handlers){handlers=[handler]}else{handlers.push(handler)}this.__handlersCount+=1;this.__handlers[event]=handlers};EventTarget.prototype.off=function(event,handler){if(typeof event!="string"||typeof handler!="function"){return}var handlers=this.__handlers[event];if(handlers){for(var i=0;i<handlers.length;++i){if(handlers[i]==handler){handlers.splice(i,1);--this.__handlersCount;return}}}};EventTarget.prototype.one=function(event,handler){var self=this;var wrapper=function(evt){self.off(event,wrapper);handler(evt)};self.on(event,wrapper)};EventTarget.prototype.trigger=function(event,eventObj){if(typeof event!="string"){return}var handlers=this.__handlers[event];if(handlers){for(var i=0;i<handlers.length;++i){handlers[i](eventObj)}}};EventTarget.prototype.handlerCount=function(){return this.__handlersCount};exports.EventTarget=EventTarget});define("src/scrollwatcher.js",["src/misc.js","src/event.js"],function(require,exports,module){module.exports=ScrollWatcher;require("src/misc.js");var EventTarget=require("src/event.js").EventTarget;var watcherList=[];if(!watcherList.forEach){watcherList.forEach=function(fn){for(var i=0;i<this.length;++i){fn.apply(this[i])}}}function ScrollWatcher(watchElement,offset){if(typeof offset=="string"){this.fromBottom=offset[0]=="-";this.offset=parseInt(offset)}else{this.fromBottom=offset<0;this.offset=offset||0}this.element=watchElement;this.emmiter=new EventTarget;this.watchY=0;this.currAbove=undefined;this.currBelow=undefined;this.prevAbove=undefined;this.prevBelow=undefined;var type=typeof watchElement;if(type=="number"){this.offset=watchElement;this.element=$(document.documentElement)}else if(type=="string"||!watchElement.length){this.element=$(watchElement)}if(viewportTop!=0){var self=this;setTimeout(function(){self.update()},18)}else{this.update()}}ScrollWatcher.prototype.on=function(event,callback){if(this.emmiter.handlerCount()==0){watcherList.push(this)}this.emmiter.on(event,callback);return this};ScrollWatcher.prototype.one=function(event,callback){var self=this;var wrapper=function(evt){self.off(event,wrapper);callback(evt)};self.on(event,wrapper);return this};ScrollWatcher.prototype.off=function(event,callback){this.emmiter.off(event,callback);if(this.emmiter.handlerCount()==0){for(var i=watcherList.length-1;i>=0;--i){if(watcherList[i]==this){watcherList.splice(i,1);break}}}return this};ScrollWatcher.prototype.trigger=function(event,eventObj){this.emmiter.trigger(event,eventObj);return this};ScrollWatcher.prototype.update=function(){this.watchY=this.element.offset().top;if(this.fromBottom){this.watchY+=theHeight.apply(this.element)+this.offset}else{this.watchY+=this.offset}this.notify()};ScrollWatcher.prototype.notify=function(){this.prevAbove=this.currAbove;this.prevBelow=this.currBelow;if(this.watchY<viewportTop){this.currAbove=true;this.currBelow=false}else if(this.watchY>viewportBottom){this.currAbove=false;this.currBelow=true}else{this.currAbove=false;this.currBelow=false}if(this.prevAbove!=this.currAbove&&this.currAbove==true){this.emmiter.trigger("scrollabove");return}if(this.prevBelow!=this.currBelow&&this.currBelow==true){this.emmiter.trigger("scrollbelow");return}if(this.currAbove==false&&this.currBelow==false){if(this.prevAbove!=false||this.prevBelow!=false){this.emmiter.trigger("scrollinto")}}};function theHeight(){var el=this[0];if(el==document.documentElement){return el.scrollHeight}else{return this.height()}}var viewportTop=0;var viewportBottom=0;var viewportHeight=0;var docHeight=0;var docEl=document.documentElement;function calcViewport(){viewportHeight=docEl.offsetHeight;viewportTop=window.scrollTop||window.scrollY;viewportBottom=viewportTop+viewportHeight;docHeight=docEl.scrollHeight}function notifyWrap(thisObj){thisObj.notify()}function updateWrap(thisObj){thisObj.update()}function onWinResize(){calcViewport();watcherList.forEach(updateWrap)}function onWinScroll(){calcViewport();watcherList.forEach(notifyWrap)}calcViewport();var resizeDebounceTO=null;var RESIZE_THRESHOLD=250;$(window).on("scroll",function(e){onWinScroll()}).on("debouncedResize",onWinResize)});define("src/tooltip.js",[],function(require,exports,module){module.exports={show:show,hide:hide,auto:auto,hideOnClick:hideOnClick,currentTarget:currentTarget};var defaultOpts={content:"",side:"top",margin:25,extraClass:""};var TIP_EDGE=10;var ARROW_SIZE=6;var tipElement=null;var $tipDom=$tipDom=$("<div class='tooltip top'><div class='tip-content'></div><span class='arrow'></span></div>").appendTo("body");var isTouchDevice=!!("ontouchstart"in window);var lastPosObject=null;function show(element,config,pos){if(typeof config=="function"){config=config(element)}config=$.extend({},defaultOpts,config);if(tipElement==element){if(lastPosObject&&pos){lastPosObject=_updatePos($tipDom,lastPosObject,pos)}return}tipElement=element.length?element[0]:element;var old_gravity=$tipDom.attr("class").replace(/left|right|top|bottom/);var noReset=!$tipDom.hasClass("shown");old_gravity=old_gravity?old_gravity[0]:"";$tipDom.attr("class","tooltip "+config.extraClass).children(".tip-content").html(typeof config.content=="function"?config.content(element):config.content);var posObj=_position($tipDom,element,config,pos);lastPosObject=posObj;if(noReset){noReset=!(old_gravity&&old_gravity!=posObj.g)}$tipDom.addClass(posObj.g+(noReset?"":" no-animate")).children(".arrow").css({left:posObj.aL,top:posObj.aT});var height=$tipDom[0].offsetHeight;$tipDom.removeClass("no-animate").toggleClass("shown",true)}function hide(element,force){if(tipElement!=element&&!force){return}$tipDom.removeClass("shown");tipElement=null}function hideOnClick(){function doHide(evt){hide(null,true);hideOnClick.__bindNextHide=false}var evt=isTouchDevice?"touchend":"click";if(!hideOnClick.__bindNextHide){hideOnClick.__bindNextHide=true;$("body").one(evt,doHide)}}function currentTarget(){return tipElement}function auto(selector,config,tracking){if(isTouchDevice){$(selector).on("touchend",selector,function(evt){if(tipElement!=evt.target){show(evt.target,config);hideOnClick()}return false})}else{$("body").on("mouseenter",selector,function(evt){show(evt.target,config);return false}).on("mouseleave",selector,function(evt){hide(evt.target);return false});if(tracking){$("body").on("mousemove",selector,function(evt){show(evt.target,config,{x:evt.pageX,y:evt.pageY});return false})}}}function _updatePos($tip,posObj,pos){var xoff,yoff;if(posObj.g=="left"||posObj.g=="right"){xoff=pos.x-posObj.baseline;yoff=pos.y-posObj.baselineAlt;posObj.baseline=pos.x;posObj.baselineAlt=pos.y}else{yoff=pos.y-posObj.baseline;xoff=pos.x-posObj.baselineAlt;posObj.baseline=pos.y;posObj.baselineAlt=pos.x}xoff+=parseInt($tip.css("left"));yoff+=parseInt($tip.css("top"));$tip.css({left:xoff,top:yoff});return posObj}function _position($tip,element,config,pos){var elementOffset=pos?{left:pos.x,top:pos.y,width:0,height:0}:$(element).offset();var tipOffset=$tip.offset();var docEl=document.documentElement;var viewportW=docEl.clientWidth;var viewportH=docEl.clientHeight;var docW=docEl.scrollWidth;var docH=docEl.scrollHeight;var scrollX=window.scrollLeft||window.scrollX;var scrollY=window.scrollTop||window.scrollY;var baseline,baselineAlt,measurement,halfTipSize;var position={x:0,y:0};var posObj={g:"left",aL:undefined,aT:undefined};if("left"==config.side||"right"==config.side){baseline=Math.round(elementOffset.left+elementOffset.width/2);baselineAlt=Math.round(elementOffset.top+elementOffset.height/2);measurement=tipOffset.width+config.margin;position.y=baselineAlt-Math.floor(tipOffset.height/2);if("left"==config.side){if(measurement<baseline-scrollX){position.x=baseline-measurement}else if(measurement<docW-baseline){position.x=baseline+config.margin;posObj.g="right"}else if(measurement<baseline){position.x=baseline-measurement}else{config.side="top"}}else{if(measurement<scrollX+viewportW-baseline){position.x=baseline+config.margin;posObj.g="right"}else if(measurement<baseline-scrollX){position.x=baseline-measurement}else if(measurement<docW-baseline){position.x=baseline+config.margin;posObj.g="right"}else{config.side="top"}}}if("bottom"==config.side||"top"==config.side){baseline=Math.round(elementOffset.top+elementOffset.height/2);baselineAlt=Math.round(elementOffset.left+elementOffset.width/2);measurement=tipOffset.height+config.margin;posObj.g="top";if("bottom"==config.side){if(measurement<scrollY+viewportH-baseline){position.y=baseline+config.margin;posObj.g="bottom"}else if(measurement<baseline-scrollY){position.y=baseline-measurement}else if(measurement<docH-baseline){position.y=baseline+config.margin;posObj.g="bottom"}else{position.y=baseline-measurement}}else{if(measurement<baseline-scrollY){position.y=baseline-measurement}else if(measurement<docH-baseline){position.y=baseline+config.margin;posObj.g="bottom"}else{position.y=baseline-measurement}}halfTipSize=Math.round(tipOffset.width/2);if(docW<tipOffset.width||baselineAlt-scrollX>=halfTipSize&&scrollX+viewportW-baselineAlt>=halfTipSize){position.x=baselineAlt-halfTipSize}else if(viewportW>=tipOffset.width){if(baselineAlt-scrollX<halfTipSize){position.x=scrollX+TIP_EDGE;if(position.x+tipOffset.width>scrollX+viewportW){position.x=scrollX+viewportW-tipOffset.width}}else{position.x=scrollX+viewportW-TIP_EDGE-tipOffset.width;if(position.x<scrollX){position.x=scrollX}}}else{if(baselineAlt<halfTipSize+TIP_EDGE){position.x=TIP_EDGE}else{position.x=baselineAlt-halfTipSize}}posObj.aL=baselineAlt-position.x-ARROW_SIZE}$tip.css({left:position.x,top:position.y});posObj.baseline=baseline;posObj.baselineAlt=baselineAlt;return posObj}});define("src/skill/skill.js",["data/skill.js","src/skill/sk-chart.js","src/scrollwatcher.js","src/tooltip.js"],function(require){var data=require("data/skill.js");var RadarChart=require("src/skill/sk-chart.js");var ScrollWatcher=require("src/scrollwatcher.js");var chart=new RadarChart(data,"W_skillChart");$("#W_skillChart").watchAutoResize().on("autoresize",function(){chart.render(chart.EVT_RESIZE)});var chartW=new ScrollWatcher(".logo",-1);chartW.one("scrollabove",function(){chart.render()});var Tooltip=require("src/tooltip.js");var tooltipOption={margin:15,extraClass:"skill",content:function(element){var data=chart.getData(element);var html="<p class='sk-tip-desc'><span class='tip-tag'>"+data.name+"</span>"+data.desc+"</p><p class='sk-tip-lv lv"+data.v+"'></p>";return html}};if(!!("ontouchstart"in window)){var __bindNextHide=false;$("#W_skillChart").on("touchend","ellipse",function(evt){var winScrollY=window.scrollTop||window.scrollY;var winScrollX=window.scrollLeft||window.scrollX;var rect=evt.target.getBoundingClientRect();var pos={x:Math.round(rect.width/2+rect.left)+winScrollX,y:Math.round(rect.height/2+rect.top)+winScrollY};console.log(evt);Tooltip.show(evt.target,tooltipOption,pos);Tooltip.hideOnClick();return false})}else{$("#W_skillChart").on("mouseover","ellipse",function(evt){Tooltip.show(evt.target,tooltipOption,{x:evt.pageX,y:evt.pageY})}).on("mousemove","ellipse",function(evt){Tooltip.show(evt.target,tooltipOption,{x:evt.pageX,y:evt.pageY})}).on("mouseout","ellipse",function(evt){Tooltip.hide(evt.target)})}});define("data/timeline.js",[],{current:[{y:"'03",left:"15%",icon:"",desc:"获得了一台古董电脑"},{y:"'07",left:"35%",icon:"",desc:"用Flash做了一个网站"},{y:"'08",left:"45%",icon:"",desc:"赚了第一笔钱"},{y:"'08",left:"50%",icon:"",desc:"上大学，orz",alpha:true,beta:true},{y:"'10",left:"60%",icon:"",desc:"开发桌面APP"},{y:"'11",left:"75%",icon:"",desc:"GUI库完成了一半"},{y:"'12",left:"85%",icon:"",desc:"转型做前端"},{y:"'12",left:"90%",icon:"",desc:"买了一台rMBP"}],alpha:[{y:"'12",left:"82%",icon:"",desc:"制作好玩的游戏"}],beta:[{y:"'10",left:"65%",icon:"",desc:"拍摄动人的电影"},{y:"'14",left:"95%",icon:"",desc:"成为新晋导演"}],start:{y:"'90",icon:"",desc:"我出生了"},end:{y:"'99",icon:"",desc:"世界继续运行"}});define("src/timeline.js",["data/timeline.js","src/tooltip.js"],function(require){var data=require("data/timeline.js");var Tooltip=require("src/tooltip.js");var canvas=SVG("W_timeline");var $currents=[];var currentLines=[];var $alphas=[];var $betas=[];var altlines=[];var $alphaStartDot;var $betaStartDot;var $alphaStartLine;var $betaStartLine;var timeline_data={};var $container=$("#W_timelineContainer");function nextID(){if(nextID.id){++nextID.id;return"tl-"+nextID.id}nextID.id=100;return nextID()}(function(){var c_height=$container.height();var h_quater=c_height/4;var h_third=c_height/3;var h_half=c_height/2;var restrict=false;function addDots(target,collection,$container){for(var i=0;i<target.length;++i){var c=target[i];var min=h_third;var size=h_third;if(restrict){min+=20;size-=40}else if(c.alpha||c.beta){restrict=true}var r=range(min,size,h_half);var id=nextID();var $dot=$("<span class='tl-dot'></span>").appendTo($container).data("id",id).css("left",c.left);timeline_data[id]={y:c.y,desc:c.desc,maxT:r.max,minT:r.min,midT:r.mid,icn:c.icon};collection.push($dot);if(c.alpha){$alphaStartDot=$dot}if(c.beta){$betaStartDot=$dot}var line=canvas.line().attr({stroke:"#b9b9b9","stroke-width":"8"});currentLines.push(line)}var line=canvas.line(0,h_half,0,h_half).attr({stroke:"#cbcbcb","stroke-width":"8","stroke-dasharray":"16, 8"});currentLines.push(line)}function range(start,s,b){var a=Math.random()*s+start;var c=Math.random()*s+start;if(Math.abs(a-b)<10){a+=a<b?-10:10}if(Math.abs(c-b)<10){c+=c<b?-10:10}var t;if((a-b)*(c-b)>0){if(a>c){c=b-(c-b)}if(c>a){a=b-(a-b)}}return{max:Math.floor(c),min:Math.floor(a),mid:Math.floor(b)}}function addAltDots(target,collection,$container){for(var i=0;i<target.length;++i){var c=target[i];var id=nextID();var $dot=$("<span class='tl-dot alt'></span>").appendTo($container).data("id",id).css("left",c.left);timeline_data[id]={y:c.y,desc:c.desc,icn:c.icon};collection.push($dot);if(i!=0){altlines.push(canvas.line().attr({stroke:"#cbcbcb","stroke-width":"8"}))}}}addAltDots(data.alpha,$alphas,$container);addAltDots(data.beta,$betas,$container);$alphaStartLine=canvas.path().fill("#cbcbcb").back();$betaStartLine=canvas.path().fill("#cbcbcb").back();var id=nextID();var d=$("<span class='tl-dot start'></span>").appendTo($container).data("id",id);timeline_data[id]={y:data.start.y,desc:data.start.desc,icn:data.start.icon};$currents.push(d);addDots(data.current,$currents,$container);id=nextID();d=$("<span class='tl-dot end'></span>").appendTo($container).data("id",id);timeline_data[id]={y:data.end.y,desc:data.end.desc,icn:data.end.icon};$currents.push(d)})();var tlTop=0;var tlCenter=0;var tlBottom=0;var tlState=-2;function redrawTimeline(force){var offset=$container.offset();var wh=window.innerHeight;var space=wh-offset.height;tlCenter=offset.top-space/2;if(space<200){space=200}tlTop=offset.top-space;tlBottom=offset.top+offset.height+space-wh;if(force){tlState=-2}arrageDots()}function arrageDots(){var scrollY=window.scrollTop||window.scrollY;if(scrollY<=tlTop){if(tlState==-1){return}scrollY=tlTop;tlState=-1}else if(scrollY>=tlBottom){if(tlState==1){return}scrollY=tlBottom;tlState=1}else{tlState=(scrollY-tlCenter)/(tlCenter-tlTop)}for(var i=1;i<$currents.length-1;++i){var $dot=$currents[i];var data=timeline_data[$dot.data("id")];var midT=data["midT"];var endT;if(tlState<.05&&tlState>-.05){$dot.css("top",midT)}else if(tlState<0){endT=data["minT"];$dot.css("top",Math.floor(midT+(midT-endT)*tlState))}else{endT=data["maxT"];$dot.css("top",Math.floor(midT+(endT-midT)*tlState))}}var c_height=Math.floor($container.height()/4);for(i=0;i<$alphas.length;++i){$dot=$alphas[i].css("top",c_height)}c_height*=3;for(i=0;i<$betas.length;++i){$dot=$betas[i].css("top",c_height)}drawLines();var tipElement=Tooltip.currentTarget();var allDots=$currents.concat($alphas,$betas);if(tipElement){for(i=0;i<allDots.length;++i){if(tipElement==allDots[i][0]){var tipOffset=allDots[i].offset();Tooltip.show(tipElement,null,{x:tipOffset.left+tipOffset.width/2,y:tipOffset.top+tipOffset.height/2});break}}}}function drawLines(){var MARGIN=4;var $dot=$currents[0];var pos1=$dot.position();var w1=$dot.width()/2+MARGIN;for(var i=1;i<$currents.length;++i){$dot=$currents[i];var pos2=$dot.position();var line=currentLines[i-1];var rad=Math.atan2(pos2.top-pos1.top,pos2.left-pos1.left);var cosR=Math.cos(rad);var sinR=Math.sin(rad);pos1.left+=Math.floor(cosR*w1);pos1.top+=Math.floor(sinR*w1);w1=$dot.width()/2+MARGIN;var x2=Math.floor(pos2.left-cosR*w1);var y2=Math.floor(pos2.top-sinR*w1);if(Math.pow(x2-pos1.left,2)+Math.pow(y2-pos1.top,2)<18){line.attr({x1:"0",y1:"0",x2:"0",y2:"0"})}else{line.attr({x1:pos1.left,y1:pos1.top,x2:x2,y2:y2})}pos1=pos2}function drawCurve($dot1,$dot2,path){var pos1=$dot1.position();var pos2=$dot2.position();var w1=$dot1.width()/2+2;var rad=Math.atan2(pos2.top-pos1.top,pos2.left-pos1.left);pos2.left-=$dot2.width()/2+4;var lx_off=pos2.top>pos1.top?1:-1;var ly_off=pos2.top>pos1.top?w1:-w1;var ry_off=4;var control_x=pos1.left+Math.floor((pos2.left-pos1.left)*.15);var p=["M",pos1.left+lx_off,pos1.top+ly_off,"Q",control_x,pos2.top-ry_off,pos2.left,pos2.top-ry_off,"L",pos2.left,pos2.top+ry_off,"Q",control_x,pos2.top+ry_off,pos1.left-lx_off,pos1.top+ly_off,"Z"].join(" ");path.attr("d",p)}drawCurve($alphaStartDot,$alphas[0],$alphaStartLine);drawCurve($betaStartDot,$betas[0],$betaStartLine);function altLineTo($dot1,$dot2,index){var line=altlines[index];var pos1=$dot1.position();var pos2=$dot2.position();line.attr({x1:pos1.left+$dot1.width()/2+4,y1:pos1.top,x2:pos2.left-$dot2.width()/2-4,y2:pos2.top})}for(i=0;i<$alphas.length-1;++i){altLineTo($alphas[i],$alphas[i+1],i)}for(i=0;i<$betas.length-1;++i){altLineTo($betas[i],$betas[i+1],i+$alphas.length-1)}}redrawTimeline();$(window).on("debouncedResize",function(){redrawTimeline(true)}).on("scroll",arrageDots);Tooltip.auto(".tl-dot",function(element){var $e=$(element);var cfg={};var data=timeline_data[$e.data("id")];cfg["content"]=data["icn"]?"<p class='tl-icon'>"+data["icn"]+"</p>":"";cfg["content"]+="<p class='tl-desc'><span class='tip-tag'>"+data["y"]+"</span><span>"+data["desc"]+"</span></p>";if($e.hasClass("start")){cfg["side"]="right"}else if($e.hasClass("end")){cfg["side"]="left"}return cfg})});define("src/sliderpuzzle.js",["src/misc.js"],function(require){var misc=require("src/misc.js");function Puzzle(url,container){var img=new Image;var self=this;img.onload=function(){img.onload=null;$(".card-left").toggleClass("ready",true).children(".loading-wrap").remove();var $c=self.$container;self.ready=true;self.onLoadImage(url,img.width,img.height)};
img.src=url;this.ready=false;this.imgWidth=0;this.imgHeight=0;this.imgLeft=0;this.imgTop=0;this.url=url;this.stylesheet=undefined;this.$container=container;this.emptyPos=0;Puzzle.ID+=1}var dpr=window.devicePixelRatio;Puzzle.ID=100;Puzzle.prototype.DPR=dpr!==undefined&&dpr>1?2:1;Puzzle.prototype.COLUMN_COUNT=4;Puzzle.prototype.TILE_COUNT=16;Puzzle.prototype.TILE_SIZE=30;Puzzle.prototype.onLoadImage=function(url,imgWidth,imgHeight){var WIDTH=this.$container.width();var HEIGHT=this.$container.height();this.imgLeft=parseInt(this.$container.css("padding-left"));this.imgTop=parseInt(this.$container.css("padding-top"));if(imgWidth==WIDTH&&imgHeight==HEIGHT){this.imgWidth=0}else{var w_r=imgWidth/WIDTH;var h_r=imgHeight/HEIGHT;if(w_r>h_r){w_r=h_r}if(w_r>1.3*this.DPR){w_r-=.15*this.DPR}this.imgWidth=imgWidth/w_r;this.imgHeight=imgHeight/w_r;this.imgLeft+=(this.imgWidth-WIDTH)/2/this.DPR;this.imgTop+=(this.imgHeight-HEIGHT)/2/this.DPR}var cName=this.prepareCSS();this.$container[0].className=cName;var tag="<span class='puzzle-item "+cName+"' style='{#s}' data-idx='{#i}' />";var html="";for(var i=0;i<this.TILE_COUNT;++i){html+=tag.replace("{#s}",this.itemStyle(i)).replace("{#i}",i)}$(html).appendTo(this.$container)};Puzzle.prototype.itemPos=function(index,a){if(!a){a={}}a["x"]=index%this.COLUMN_COUNT*this.TILE_SIZE;a["y"]=Math.floor(index/this.COLUMN_COUNT)*this.TILE_SIZE;return a};Puzzle.prototype.itemStyle=function(index,positionIndex){var tr="translate(Xpx,Ypx)";var bg=["background-position:-",0,"px -",0,"px"];var x,y,pos;Puzzle.prototype.itemStyle=function(index,positionIndex){pos=this.itemPos(index);bg[1]=pos.x+this.imgLeft;bg[3]=pos.y+this.imgTop;if(positionIndex!==undefined&&positionIndex!=index){pos.x=positionIndex%this.COLUMN_COUNT*this.TILE_SIZE;pos.y=Math.floor(positionIndex/this.COLUMN_COUNT)*this.TILE_SIZE}return misc.transformCSS(tr.replace("X",pos.x).replace("Y",pos.y))+bg.join("")};return this.itemStyle(index,positionIndex)};Puzzle.prototype.prepareCSS=function(){var cName="pzli"+Puzzle.ID;var bgsize="";var bgpos="";if(this.imgWidth!=0){bgsize="-webkit-background-size:{#bgsize} !important;"+"-moz-background-size:{#bgsize} !important;"+"-o-background-size:{#bgsize} !important;"+"background-size:{#bgsize} !important;";bgsize=bgsize.replace(/\{#bgsize\}/g,this.imgWidth+"px auto")}var x=this.imgLeft-parseInt(this.$container.css("padding-left"));var y=this.imgLeft-parseInt(this.$container.css("padding-top"));if(x!=0&&y!=0){bgpos="background-position:-"+x+"px -"+y+"px;"}var css=".{#class} { background-image:url({#url}) !important; {#bgpos} {#bgsize}}".replace("{#class}",cName).replace("{#bgpos}",bgpos).replace("{#bgsize}",bgsize).replace("{#url}",this.url);this.stylesheet=misc.insertCSS(this.stylesheet,css);return cName};Puzzle.prototype.random=function(){if(!this.ready){return}var len=this.TILE_COUNT-1;var r=new Array(len);var switch_idx=0;var t;for(var i=0;i<len;++i){switch_idx=Math.floor(Math.random()*(len-i))+i;t=r[switch_idx];r[switch_idx]=r[i]===undefined?i:r[i];r[i]=t===undefined?switch_idx:t}var parity=0;for(i=0;i<len;++i){t=r[i];for(var j=i+1;j<len;++j){if(t>r[j]){++parity}}}console.log(r,parity);this.emptyPos=Math.floor(Math.random()*this.COLUMN_COUNT)+this.COLUMN_COUNT*(Math.floor(Math.random()*this.COLUMN_COUNT/2)*2+(parity+1)%2);r.splice(this.emptyPos,0,len);console.log(r);var pos={x:0,y:0};var $tiles=this.$container.addClass("random").children(".puzzle-item");for(i=0;i<$tiles.length;++i){this.itemPos(i,pos);$tiles.eq(r[i]).data("pos",i).transform("translate("+pos.x+"px, "+pos.y+"px)")}var self=this;setTimeout(function(){self.$container.removeClass("random")},300)};Puzzle.prototype.solve=function(layoutArr){};Puzzle.prototype.direction=function(pos1,pos2){var c=this.COLUMN_COUNT;var y1=Math.floor(pos1/c);var y2=Math.floor(pos2/c);var x1=pos1%c;var x2=pos2%c;var r={x:x2-x1,y:y2-y1};r.adjoining=Math.abs(r.x)+Math.abs(r.y)==1;return r};Puzzle.prototype.slide=function(element){var $el=$(element);var pos=$el.data("pos");if(!this.direction(this.emptyPos,pos).adjoining)return;var newPos=this.itemPos(this.emptyPos);$el.data("pos",this.emptyPos).transform("translate("+newPos.x+"px, "+newPos.y+"px)");this.emptyPos=pos};Puzzle.prototype.checkDone=function(){var $tiles=this.$container.children(".puzzle-item");var done=true;for(var i=$tiles.length-2;i>=0;--i){var $t=$tiles.eq(i);if($t.data("idx")!=$t.data("pos")){done=false;break}}if(done){$(".card-left").removeClass("playing");i=this.TILE_COUNT-1;var pos=this.itemPos(i);this.$container.children(".puzzle-item").eq(i).data("pos",i).transform("translate("+pos.x+"px, "+pos.y+"px)")}};$(function(){var $el=$("#W_puzzle");var url=window.getComputedStyle($el[0]).backgroundImage;var urlextract=/url\((.+)\)$/.exec(url);if(!urlextract){return}if(urlextract[1])url=urlextract[1];if(!url){console.log("Something Bad Happens.")}else{var p=new Puzzle(url,$el);$("#W_playGame").on("click",function(){p.random();$(".card-left").addClass("playing");return false});$el.on("click",".puzzle-item",function(){p.slide(this);p.checkDone();return false})}})});define("src/contact.js",["src/tooltip.js"],function(require){var Tooltip=require("src/tooltip.js");var lastContent="";var contacting=false;$("#W_email, #W_content").on("blur",function(){console.log("blur");Tooltip.hide(this)});$("#W_email").on("invalid",function(){invalid($(this),"请输入你的Email。");return false}).on("keyup",onInputChange);$("#W_content").on("invalid",function(){invalid($(this),"请输入5个字以上有意义的内容。");return false}).on("keyup",onInputChange);$("#W_contact").on("submit",function(evt){Tooltip.hide($("#W_submit")[0]);if(contacting){return false}var d=validate();if(!d){return false}if(lastContent==d.content){invalid($("#W_content"),"你刚才已经发过一遍了。");return false}lastContent=d.content;showLoading();$.ajax({url:"http://lmmail.herokuapp.com",dataType:"jsonp",type:"GET",data:d,success:onSendSuccess,error:onSendSuccess,complete:hideLoading});return false});function onInputChange(){var value=$(this).val();if(this.id=="W_email"){if(/[\w\d_\.\-]+@([\w\d_\-]+\.)+[\w\d]{2,4}/.test(emailVal)){Tooltip.hide(this)}}else if(this.id=="W_content"){if(value.length>5){Tooltip.hide(this)}}}function validate(){var $email=$("#W_email");var $content=$("#W_content");var emailVal=$email.val();var contentVal=$content.val();if(!contentVal||contentVal.length<6){invalid($content,"请输入5个字以上有意义的内容。");return null}if(!emailVal||!/[\w\d_\.\-]+@([\w\d_\-]+\.)+[\w\d]{2,4}/.test(emailVal)){invalid($email,"请输入你的Email。");return null}return{email:emailVal,content:contentVal}}var invalidTM=null;function invalid($target,error){if(invalidTM==null){Tooltip.show($target[0],{content:error,margin:30,extraClass:"error"});invalidTM=setTimeout(function(){invalidTM=null},50)}}function showLoading(){contacting=true;$("#W_contact").addClass("contacting")}function hideLoading(){contacting=false;$("#W_contact").removeClass("contacting")}function onSendSuccess(data){var e=data&&data.result=="Success"?"发送成功，我会尽快回复你的。":"失败了，不如你直接发邮件给我吧：<a href='mailto:liangmorr@gmail.com'>liangmorr@gmail.com</a>";Tooltip.show($("#W_submit")[0],{content:e,margin:30,extraClass:data&&data.result=="Success"?"success":"error"});setTimeout(function(){Tooltip.hide($("#W_submit")[0])},2e3)}});define("src/print.js",["data/skill.js"],function(require){$(".personal .value.name").html("梁文浩");$(".personal .value.age").html((new Date).getUTCFullYear()-1990);$(".personal .value.phone").html("136"+"5130"+"2717");(function(){var sk_data=require("data/skill.js");var labels=sk_data.shortLabels;var html_arr=[];var html="";var data=sk_data.datasets[1].data;for(var i=0;i<data.length;++i){if(data[i]!=null){html_arr.push('<li><span class="label">'+labels[i]+'</span><span class="level level'+ +data[i].v+'"></span></li>')}}data=sk_data.datasets[0].data;for(i=0;i<data.length;++i){if(data[i]!=null){html_arr.push('<li class="basic"><span class="label">'+labels[i]+'</span><span class="level level'+ +data[i].v+'"></span></li>')}}for(i=0;i<html_arr.length;++i){if(i%5==0){if(i!=0){html+="</ul>"}html+='<ul class="skill-list">'}html+=html_arr[i]}$(html).appendTo($("#W_printSkill"))})()});define("main.js",["src/definition.js","src/skill/skill.js","src/timeline.js","src/sliderpuzzle.js","src/contact.js","src/print.js","src/misc.js","src/scrollwatcher.js"],function(require){require("src/definition.js");require("src/skill/skill.js");require("src/timeline.js");require("src/sliderpuzzle.js");require("src/contact.js");require("src/print.js");(function(){function CiteCarousel2D(){var index=0;function nextCiting(){var $cites=$("#W_citeCarousel .cite-wrap").eq(0);$cites.animate({"margin-top":-$cites.height()},400,"linear",function(){$("#W_citeCarousel .cite-wrap").eq(0).appendTo($("#W_citeCarousel")).css("margin-top",0)});setTimeout(nextCiting,5e3)}setTimeout(nextCiting,5e3)}var index=0;var child_len=0;var misc=require("src/misc.js");function CiteCarousel3D(){child_len=$("#W_citeCarousel").removeClass("cite-con").children().wrap("<div class='cite-con'></div>").length;index=child_len-1;function flipDone(){$("#W_citeCarousel").off(misc.animationEnd,flipDone).removeClass("cite-play");setTimeout(flip,5e3);return false}function flip(){var $con=$("#W_citeCarousel");var $chs=$con.children();$con.children(".head").removeClass("head");$con.children(".tail").removeClass("tail");$chs.eq(index).addClass("head");++index;if(index==child_len){index=0}$chs.eq(index).addClass("tail");$con.on(misc.animationEnd,flipDone).addClass("cite-play")}setTimeout(flip,2e3)}(misc.threed?CiteCarousel3D:CiteCarousel2D)()})();(function(){var ScrollWatcher=require("src/scrollwatcher.js");var logoOffset=$(".logo").height()+4;var logoW=new ScrollWatcher(".intro-wrap-holder",-logoOffset);logoW.on("scrollabove",function(){$(".top-line").show()}).on("scrollinto",function(){$(".top-line").hide()});var shortcutW=new ScrollWatcher(".page3",0);shortcutW.on("scrollinto",function(){$(".shortcut-nav").toggleClass("sticky",true)}).on("scrollbelow",function(){$(".shortcut-nav").toggleClass("sticky",false)});var scrolling=false;function scrollPage(toggleItem,dirDown){if(toggleItem){$(toggleItem).toggleClass("active",true);setTimeout(function(){$(toggleItem).toggleClass("active",false)},200)}if(scrolling){return}var scrollY=window.scrollTop||window.scrollY;var $pages=$(".page-wrap");var toScrollY=-1;var i=0;var offset;if(dirDown){for(;i<$pages.length;++i){offset=$pages.eq(i).offset();if(scrollY<Math.round(offset.top)){toScrollY=Math.round(offset.top);break}}}else{for(i=$pages.length-1;i>=0;--i){offset=$pages.eq(i).offset();if(scrollY>offset.top){toScrollY=offset.top;break}}}if(toScrollY==-1){toScrollY=dirDown?document.documentElement.scrollHeight-window.innerHeight:0}if(toScrollY!=scrollY){scrolling=true;$.genericAnimate(toScrollY-scrollY,function(value){window.scrollTo(0,Math.floor(scrollY+value));if(scrollY+value==toScrollY){scrolling=false}})}}function pageUp(effect){scrollPage(effect?"#W_vimK":"",false)}function pageDown(effect){scrollPage(effect?"#W_vimJ":"",true)}$("body").on("keypress",function(evt){var kc=evt.which||evt.keyCode;if(kc==106){pageDown(true)}else if(kc==107){pageUp(true)}}).on("keydown",function(evt){var kc=evt.which||evt.keyCode;if(kc==80&&evt.metaKey){$("#W_ctrlP").toggleClass("active",true);setTimeout(function(){$("#W_ctrlP").toggleClass("active",false)},200)}});$("#W_vimJ").on("click",pageDown);$("#W_vimK").on("click",pageUp);$("#W_ctrlP").on("click",function(){window.print()})})()});