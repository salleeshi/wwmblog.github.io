(function(){this.SVG=function(element){if(SVG.supported)return new SVG.Doc(element)};this.svg=function(element){console.warn("WARNING: svg() is deprecated, please use SVG() instead.");return SVG(element)};SVG.ns="http://www.w3.org/2000/svg";SVG.xlink="http://www.w3.org/1999/xlink";SVG.did=1e3;SVG.eid=function(name){return"Svgjs"+name.charAt(0).toUpperCase()+name.slice(1)+SVG.did++};SVG.create=function(name){var element=document.createElementNS(this.ns,name);element.setAttribute("id",this.eid(name));return element};SVG.extend=function(){var modules,methods,key,i;modules=Array.prototype.slice.call(arguments);methods=modules.pop();for(i=modules.length-1;i>=0;i--)if(modules[i])for(key in methods)modules[i].prototype[key]=methods[key]};SVG.get=function(id){var node=document.getElementById(id);if(node)return node.instance};SVG.supported=function(){return!!document.createElementNS&&!!document.createElementNS(SVG.ns,"svg").createSVGRect}();if(!SVG.supported)return false;SVG.regex={test:function(value,test){return this[test].test(value)},unit:/^([\d\.]+)([a-z%]{0,2})$/,hex:/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,rgb:/rgb\((\d+),(\d+),(\d+),([\d\.]+)\)/,hsb:/hsb\((\d+),(\d+),(\d+),([\d\.]+)\)/,isHex:/^#[a-f0-9]{3,6}$/i,isRgb:/^rgb\(/,isHsb:/^hsb\(/,isCss:/[^:]+:[^;]+;?/,isStyle:/^font|text|leading|cursor/,isBlank:/^(\s+)?$/,isNumber:/^-?[\d\.]+$/};SVG.default={matrix:"1,0,0,1,0,0",attrs:{"fill-opacity":1,"stroke-opacity":1,"stroke-width":0,fill:"#000",stroke:"#000",opacity:1,x:0,y:0,cx:0,cy:0,width:0,height:0,r:0,rx:0,ry:0,offset:0},trans:function(){return{x:0,y:0,scaleX:1,scaleY:1,rotation:0,skewX:0,skewY:0,matrix:this.matrix,a:1,b:0,c:0,d:1,e:0,f:0}}};SVG.Color=function(color){var match;this.r=0;this.g=0;this.b=0;if(typeof color=="string"){if(SVG.regex.isRgb.test(color)){match=SVG.regex.rgb.exec(color.replace(/\s/g,""));this.r=parseInt(m[1]);this.g=parseInt(m[2]);this.b=parseInt(m[3])}else if(SVG.regex.isHex.test(color)){match=SVG.regex.hex.exec(this._fullHex(color));this.r=parseInt(match[1],16);this.g=parseInt(match[2],16);this.b=parseInt(match[3],16)}else if(SVG.regex.isHsb.test(color)){match=SVG.regex.hsb.exec(color.replace(/\s/g,""));color=this._hsbToRgb(match[1],match[2],match[3])}}else if(typeof color=="object"){if(SVG.Color.isHsb(color))color=this._hsbToRgb(color.h,color.s,color.b);this.r=color.r;this.g=color.g;this.b=color.b}};SVG.extend(SVG.Color,{toString:function(){return this.toHex()},toHex:function(){return"#"+this._compToHex(this.r)+this._compToHex(this.g)+this._compToHex(this.b)},toRgb:function(){return"rgb("+[this.r,this.g,this.b].join()+")"},brightness:function(){return this.r/255*.3+this.g/255*.59+this.b/255*.11},_hsbToRgb:function(h,s,v){var vs,vsf;h=parseInt(h)%360;if(h<0)h+=360;s=parseInt(s);s=s>100?100:s;v=parseInt(v);v=(v<0?0:v>100?100:v)*255/100;vs=v*s/100;vsf=vs*(h*256/60%256)/256;switch(Math.floor(h/60)){case 0:r=v;g=v-vs+vsf;b=v-vs;break;case 1:r=v-vsf;g=v;b=v-vs;break;case 2:r=v-vs;g=v;b=v-vs+vsf;break;case 3:r=v-vs;g=v-vsf;b=v;break;case 4:r=v-vs+vsf;g=v-vs;b=v;break;case 5:r=v;g=v-vs;b=v-vsf;break}return{r:Math.floor(r+.5),g:Math.floor(g+.5),b:Math.floor(b+.5)}},_fullHex:function(hex){return hex.length==4?["#",hex.substring(1,2),hex.substring(1,2),hex.substring(2,3),hex.substring(2,3),hex.substring(3,4),hex.substring(3,4)].join(""):hex},_compToHex:function(comp){var hex=comp.toString(16);return hex.length==1?"0"+hex:hex}});SVG.Color.test=function(color){color+="";return SVG.regex.isHex.test(color)||SVG.regex.isRgb.test(color)||SVG.regex.isHsb.test(color)};SVG.Color.isRgb=function(color){return color&&typeof color.r=="number"};SVG.Color.isHsb=function(color){return color&&typeof color.h=="number"};SVG.ViewBox=function(element){var x,y,width,height,box=element.bbox(),view=(element.attr("viewBox")||"").match(/[\d\.]+/g);this.x=box.x;this.y=box.y;this.width=element.node.offsetWidth||element.attr("width");this.height=element.node.offsetHeight||element.attr("height");if(view){x=parseFloat(view[0]);y=parseFloat(view[1]);width=parseFloat(view[2])-x;height=parseFloat(view[3])-y;this.zoom=this.width/this.height>width/height?this.height/height:this.width/width;this.x=x;this.y=y;this.width=width;this.height=height}this.zoom=this.zoom||1};SVG.extend(SVG.ViewBox,{toString:function(){return this.x+" "+this.y+" "+this.width+" "+this.height}});SVG.BBox=function(element){var box=element.node.getBBox();this.x=box.x+element.trans.x;this.y=box.y+element.trans.y;this.width=box.width*element.trans.scaleX;this.height=box.height*element.trans.scaleY;this.cx=this.x+this.width/2;this.cy=this.y+this.height/2};SVG.Element=function(node){this._stroke=SVG.default.attrs.stroke;this.styles={};this.trans=SVG.default.trans();if(this.node=node){this.type=node.nodeName;this.node.instance=this}};SVG.extend(SVG.Element,{x:function(x){if(x)x/=this.trans.scaleX;return this.attr("x",x)},y:function(y){if(y)y/=this.trans.scaleY;return this.attr("y",y)},cx:function(x){return x==null?this.bbox().cx:this.x(x-this.bbox().width/2)},cy:function(y){return y==null?this.bbox().cy:this.y(y-this.bbox().height/2)},move:function(x,y){return this.x(x).y(y)},center:function(x,y){return this.cx(x).cy(y)},size:function(width,height){return this.attr({width:width,height:height})},clone:function(){var clone,attr,type=this.type;clone=type=="rect"||type=="ellipse"?this.parent[type](0,0):type=="line"?this.parent[type](0,0,0,0):type=="image"?this.parent[type](this.src):type=="text"?this.parent[type](this.content):type=="path"?this.parent[type](this.attr("d")):type=="polyline"||type=="polygon"?this.parent[type](this.attr("points")):type=="g"?this.parent.group():this.parent[type]();attr=this.attr();delete attr.id;clone.attr(attr);clone.trans=this.trans;return clone.transform({})},remove:function(){if(this.parent)this.parent.removeElement(this);return this},doc:function(type){return this._parent(type||SVG.Doc)},attr:function(a,v,n){if(a==null){a={};v=this.node.attributes;for(n=v.length-1;n>=0;n--)a[v[n].nodeName]=v[n].nodeValue;return a}else if(typeof a=="object"){for(v in a)this.attr(v,a[v])}else if(v===null){this.node.removeAttribute(a)}else if(v==null){if(this._isStyle(a)){return a=="text"?this.content:a=="leading"?this.leading():this.style(a)}else{v=this.node.getAttribute(a);return v==null?SVG.default.attrs[a]:SVG.regex.test(v,"isNumber")?parseFloat(v):v}}else if(a=="style"){return this.style(v)}else{if(a=="x"&&this instanceof SVG.Text)for(n=this.lines.length-1;n>=0;n--)this.lines[n].attr(a,v);if(a=="stroke-width")this.attr("stroke",parseFloat(v)>0?this._stroke:null);else if(a=="stroke")this._stroke=v;if(SVG.Color.test(v)||SVG.Color.isRgb(v)||SVG.Color.isHsb(v))v=new SVG.Color(v).toHex();n!=null?this.node.setAttributeNS(n,a,v):this.node.setAttribute(a,v);if(this._isStyle(a)){a=="text"?this.text(v):a=="leading"?this.leading(v):this.style(a,v);if(this.rebuild)this.rebuild()}}return this},transform:function(o,v){if(typeof o==="string"){if(arguments.length<2)return this.trans[o];var transform={};transform[o]=v;return this.transform(transform)}var transform=[];o=this._parseMatrix(o);for(v in o)if(o[v]!=null)this.trans[v]=o[v];this.trans.matrix=this.trans.a+","+this.trans.b+","+this.trans.c+","+this.trans.d+","+this.trans.e+","+this.trans.f;o=this.trans;if(o.matrix!=SVG.default.matrix)transform.push("matrix("+o.matrix+")");if(o.rotation!=0){transform.push("rotate("+o.rotation+","+(o.cx!=null?o.cx:this.bbox().cx)+","+(o.cy!=null?o.cy:this.bbox().cy)+")")}if(o.scaleX!=1||o.scaleY!=1)transform.push("scale("+o.scaleX+","+o.scaleY+")");if(o.skewX!=0)transform.push("skewX("+o.skewX+")");if(o.skewY!=0)transform.push("skewY("+o.skewY+")");if(o.x!=0||o.y!=0)transform.push("translate("+o.x/o.scaleX+","+o.y/o.scaleY+")");if(this._offset)transform.push("translate("+-this._offset.x+","+-this._offset.y+")");if(transform.length>0)this.node.setAttribute("transform",transform.join(" "));return this},style:function(s,v){if(arguments.length==0){return this.attr("style")||""}else if(arguments.length<2){if(typeof s=="object"){for(v in s)this.style(v,s[v])}else if(SVG.regex.isCss.test(s)){s=s.split(";");for(var i=0;i<s.length;i++){v=s[i].split(":");if(v.length==2)this.style(v[0].replace(/\s+/g,""),v[1].replace(/^\s+/,"").replace(/\s+$/,""))}}else{return this.styles[s]}}else if(v===null||SVG.regex.test(v,"isBlank")){delete this.styles[s]}else{this.styles[s]=v}s="";for(v in this.styles)s+=v+":"+this.styles[v]+";";this.node.setAttribute("style",s);return this},data:function(a,v,r){if(arguments.length<2){try{return JSON.parse(this.attr("data-"+a))}catch(e){return this.attr("data-"+a)}}else{this.attr("data-"+a,v===null?null:r===true?v:JSON.stringify(v))}return this},bbox:function(){return new SVG.BBox(this)},inside:function(x,y){var box=this.bbox();return x>box.x&&y>box.y&&x<box.x+box.width&&y<box.y+box.height},show:function(){return this.style("display","")},hide:function(){return this.style("display","none")},visible:function(){return this.style("display")!="none"},_parent:function(parent){var element=this;while(element!=null&&!(element instanceof parent))element=element.parent;return element},_isStyle:function(a){return typeof a=="string"?SVG.regex.test(a,"isStyle"):false},_parseMatrix:function(o){if(o.matrix){var m=o.matrix.replace(/\s/g,"").split(",");if(m.length==6){o.a=parseFloat(m[0]);o.b=parseFloat(m[1]);o.c=parseFloat(m[2]);o.d=parseFloat(m[3]);o.e=parseFloat(m[4]);o.f=parseFloat(m[5])}}return o}});SVG.Container=function(element){this.constructor.call(this,element)};SVG.Container.prototype=new SVG.Element;SVG.extend(SVG.Container,{children:function(){return this._children||(this._children=[])},add:function(element,i){if(!this.has(element)){i=i==null?this.children().length:i;if(element.parent){var index=element.parent.children().indexOf(element);element.parent.children().splice(index,1)}this.children().splice(i,0,element);this.node.insertBefore(element.node,this.node.childNodes[i]||null);element.parent=this}return this},put:function(element,i){this.add(element,i);return element},has:function(element){return this.children().indexOf(element)>=0},each:function(block){var index,children=this.children();for(index=0,length=children.length;index<length;index++)if(children[index]instanceof SVG.Shape)block.apply(children[index],[index,children]);return this},removeElement:function(element){var i=this.children().indexOf(element);this.children().splice(i,1);this.node.removeChild(element.node);element.parent=null;return this},defs:function(){return this._defs||(this._defs=this.put(new SVG.Defs,0))},level:function(){return this.removeElement(this.defs()).put(this.defs(),0)},group:function(){return this.put(new SVG.G)},rect:function(width,height){return this.put((new SVG.Rect).size(width,height))},circle:function(size){return this.ellipse(size,size)},ellipse:function(width,height){return this.put((new SVG.Ellipse).size(width,height).move(0,0))},line:function(x1,y1,x2,y2){return this.put((new SVG.Line).plot(x1,y1,x2,y2))},polyline:function(points,unbiased){return this.put(new SVG.Polyline(unbiased)).plot(points)},polygon:function(points,unbiased){return this.put(new SVG.Polygon(unbiased)).plot(points)},path:function(data,unbiased){return this.put(new SVG.Path(unbiased)).plot(data)},image:function(source,width,height){width=width!=null?width:100;return this.put((new SVG.Image).load(source).size(width,height!=null?height:width))},text:function(text){return this.put((new SVG.Text).text(text))},nested:function(){return this.put(new SVG.Nested)},gradient:function(type,block){return this.defs().gradient(type,block)},pattern:function(width,height,block){return this.defs().pattern(width,height,block)},mask:function(){return this.defs().put(new SVG.Mask)},clip:function(){return this.defs().put(new SVG.Clip)},first:function(){return this.children()[0]instanceof SVG.Defs?this.children()[1]:this.children()[0]},last:function(){return this.children()[this.children().length-1]},viewbox:function(v){if(arguments.length==0)return new SVG.ViewBox(this);v=arguments.length==1?[v.x,v.y,v.width,v.height]:Array.prototype.slice.call(arguments);return this.attr("viewBox",v.join(" "))},clear:function(){var childrens=this.children();for(var i=childrens.length-1;i>=0;i--){var ch=childrens[i];if(ch.type!="defs"){this.removeElement(this.children()[i])}else{while(ch.firstChild){ch.removeChild(ch.firstChild)}}}return this}});SVG.FX=function(element){this.target=element};SVG.extend(SVG.FX,{animate:function(d,ease,delay){var fx=this;if(typeof d=="object"){delay=d.delay;ease=d.ease;d=d.duration}this.timeout=setTimeout(function(){d=d==null?1e3:d;ease=ease||"<>";var akeys,tkeys,skeys,interval=1e3/60,element=fx.target,start=(new Date).getTime(),finish=start+d;fx.interval=setInterval(function(){var i,key,time=(new Date).getTime(),pos=time>finish?1:(time-start)/d;if(akeys==null){akeys=[];for(key in fx.attrs)akeys.push(key)}if(tkeys==null){tkeys=[];for(key in fx.trans)tkeys.push(key)}if(skeys==null){skeys=[];for(key in fx.styles)skeys.push(key)}pos=ease=="<>"?-Math.cos(pos*Math.PI)/2+.5:ease==">"?Math.sin(pos*Math.PI/2):ease=="<"?-Math.cos(pos*Math.PI/2)+1:ease=="-"?pos:typeof ease=="function"?ease(pos):pos;if(fx._x)element.x(fx._at(fx._x,pos));else if(fx._cx)element.cx(fx._at(fx._cx,pos));if(fx._y)element.y(fx._at(fx._y,pos));else if(fx._cy)element.cy(fx._at(fx._cy,pos));if(fx._size)element.size(fx._at(fx._size.width,pos),fx._at(fx._size.height,pos));if(fx._viewbox)element.viewbox(fx._at(fx._viewbox.x,pos),fx._at(fx._viewbox.y,pos),fx._at(fx._viewbox.width,pos),fx._at(fx._viewbox.height,pos));for(i=akeys.length-1;i>=0;i--)element.attr(akeys[i],fx._at(fx.attrs[akeys[i]],pos));for(i=tkeys.length-1;i>=0;i--)element.transform(tkeys[i],fx._at(fx.trans[tkeys[i]],pos));for(i=skeys.length-1;i>=0;i--)element.style(skeys[i],fx._at(fx.styles[skeys[i]],pos));if(fx._during)fx._during.call(element,pos,function(from,to){return fx._at({from:from,to:to},pos)});if(time>finish){clearInterval(fx.interval);fx._after?fx._after.apply(element,[fx]):fx.stop()}},d>interval?interval:d)},delay||0);return this},bbox:function(){return this.target.bbox()},attr:function(a,v,n){if(typeof a=="object")for(var key in a)this.attr(key,a[key]);else this.attrs[a]={from:this.target.attr(a),to:v};return this},transform:function(o,v){if(arguments.length==1){o=this.target._parseMatrix(o);delete o.matrix;for(v in o)this.trans[v]={from:this.target.trans[v],to:o[v]}}else{var transform={};transform[o]=v;this.transform(transform)}return this},style:function(s,v){if(typeof s=="object")for(var key in s)this.style(key,s[key]);else this.styles[s]={from:this.target.style(s),to:v};return this},x:function(x){this._x={from:this.target.x(),to:x};return this},y:function(y){this._y={from:this.target.y(),to:y};return this},cx:function(x){this._cx={from:this.target.cx(),to:x};return this},cy:function(y){this._cy={from:this.target.cy(),to:y};return this},move:function(x,y){return this.x(x).y(y)},center:function(x,y){return this.cx(x).cy(y)},size:function(width,height){if(this.target instanceof SVG.Text){this.attr("font-size",width)}else{var box=this.target.bbox();this._size={width:{from:box.width,to:width},height:{from:box.height,to:height}}}return this},viewbox:function(x,y,width,height){if(this.target instanceof SVG.Container){var box=this.target.viewbox();this._viewbox={x:{from:box.x,to:x},y:{from:box.y,to:y},width:{from:box.width,to:width},height:{from:box.height,to:height}}}return this},during:function(during){this._during=during;return this},after:function(after){this._after=after;return this},stop:function(){clearTimeout(this.timeout);clearInterval(this.interval);this.attrs={};this.trans={};this.styles={};delete this._x;delete this._y;delete this._cx;delete this._cy;delete this._size;delete this._after;delete this._during;delete this._viewbox;return this},_at:function(o,pos){return typeof o.from=="number"?o.from+(o.to-o.from)*pos:SVG.regex.unit.test(o.to)?this._unit(o,pos):o.to&&(o.to.r||SVG.Color.test(o.to))?this._color(o,pos):pos<1?o.from:o.to},_unit:function(o,pos){var match,from;match=SVG.regex.unit.exec(o.from.toString());from=parseFloat(match?match[1]:0);match=SVG.regex.unit.exec(o.to);return from+(parseFloat(match[1])-from)*pos+match[2]},_color:function(o,pos){var from,to;pos=pos<0?0:pos>1?1:pos;from=new SVG.Color(o.from);to=new SVG.Color(o.to);return new SVG.Color({r:~~(from.r+(to.r-from.r)*pos),g:~~(from.g+(to.g-from.g)*pos),b:~~(from.b+(to.b-from.b)*pos)}).toHex()}});SVG.extend(SVG.Element,{animate:function(d,ease,delay){return(this.fx||(this.fx=new SVG.FX(this))).stop().animate(d,ease,delay)},stop:function(){if(this.fx)this.fx.stop();return this}});["click","dblclick","mousedown","mouseup","mouseover","mouseout","mousemove","mouseenter","mouseleave","touchstart","touchend","touchmove","touchcancel"].forEach(function(event){SVG.Element.prototype[event]=function(f){var self=this;this.node["on"+event]=typeof f=="function"?function(){return f.apply(self,arguments)}:null;return this}});SVG.on=function(node,event,listener){if(node.addEventListener)node.addEventListener(event,listener,false);else node.attachEvent("on"+event,listener)};SVG.off=function(node,event,listener){if(node.removeEventListener)node.removeEventListener(event,listener,false);else node.detachEvent("on"+event,listener)};SVG.extend(SVG.Element,{on:function(event,listener){SVG.on(this.node,event,listener);return this},off:function(event,listener){SVG.off(this.node,event,listener);return this}});SVG.G=function(){this.constructor.call(this,SVG.create("g"))};SVG.G.prototype=new SVG.Container;SVG.extend(SVG.G,{x:function(x){return x==null?this.trans.x:this.transform("x",x)},y:function(y){return y==null?this.trans.y:this.transform("y",y)},defs:function(){return this.doc().defs()}});SVG.extend(SVG.Element,{siblings:function(){return this.parent.children()},position:function(){return this.siblings().indexOf(this)},next:function(){return this.siblings()[this.position()+1]},previous:function(){return this.siblings()[this.position()-1]},forward:function(){return this.parent.removeElement(this).put(this,this.position()+1)},backward:function(){this.parent.level();var i=this.position();if(i>1)this.parent.removeElement(this).add(this,i-1);return this},front:function(){return this.parent.removeElement(this).put(this)},back:function(){this.parent.level();if(this.position()>1)this.parent.removeElement(this).add(this,0);return this}});SVG.Defs=function(){this.constructor.call(this,SVG.create("defs"))};SVG.Defs.prototype=new SVG.Container;SVG.Mask=function(){this.constructor.call(this,SVG.create("mask"))};SVG.Mask.prototype=new SVG.Container;SVG.extend(SVG.Element,{maskWith:function(element){this.mask=element instanceof SVG.Mask?element:this.parent.mask().add(element);return this.attr("mask","url(#"+this.mask.attr("id")+")")}});SVG.Clip=function(){this.constructor.call(this,SVG.create("clipPath"))};SVG.Clip.prototype=new SVG.Container;SVG.extend(SVG.Element,{clipWith:function(element){this.clip=element instanceof SVG.Clip?element:this.parent.clip().add(element);return this.attr("clip-path","url(#"+this.clip.attr("id")+")")}});SVG.Pattern=function(type){this.constructor.call(this,SVG.create("pattern"))};SVG.Pattern.prototype=new SVG.Container;SVG.extend(SVG.Pattern,{fill:function(){return"url(#"+this.attr("id")+")"}});SVG.extend(SVG.Defs,{pattern:function(width,height,block){var element=this.put(new SVG.Pattern);block(element);return element.attr({x:0,y:0,width:width,height:height,patternUnits:"userSpaceOnUse"})}});SVG.Gradient=function(type){this.constructor.call(this,SVG.create(type+"Gradient"));this.type=type};SVG.Gradient.prototype=new SVG.Container;SVG.extend(SVG.Gradient,{from:function(x,y){return this.type=="radial"?this.attr({fx:x+"%",fy:y+"%"}):this.attr({x1:x+"%",y1:y+"%"})},to:function(x,y){return this.type=="radial"?this.attr({cx:x+"%",cy:y+"%"}):this.attr({x2:x+"%",y2:y+"%"})},radius:function(radius){return this.type=="radial"?this.attr({r:radius+"%"}):this},at:function(stop){return this.put(new SVG.Stop(stop))},update:function(block){while(this.node.hasChildNodes())this.node.removeChild(this.node.lastChild);block(this);return this},fill:function(){return"url(#"+this.attr("id")+")"}});SVG.extend(SVG.Defs,{gradient:function(type,block){var element=this.put(new SVG.Gradient(type));block(element);return element}});SVG.Stop=function(stop){this.constructor.call(this,SVG.create("stop"));this.update(stop)};SVG.Stop.prototype=new SVG.Element;SVG.extend(SVG.Stop,{update:function(o){var index,attr=["opacity","color"];for(index=attr.length-1;index>=0;index--)if(o[attr[index]]!=null)this.style("stop-"+attr[index],o[attr[index]]);return this.attr("offset",(o.offset!=null?o.offset:this.attr("offset"))+"%")}});SVG.Doc=function(element){this.constructor.call(this,SVG.create("svg"));this.parent=typeof element=="string"?document.getElementById(element):element;this.attr({xmlns:SVG.ns,version:"1.1",width:"100%",height:"100%"}).attr("xlink",SVG.xlink,SVG.ns).defs();this.stage()};SVG.Doc.prototype=new SVG.Container;SVG.Doc.prototype.stage=function(){var check,element=this,wrapper=document.createElement("div");wrapper.style.cssText="position:relative;height:100%;";element.parent.appendChild(wrapper);wrapper.appendChild(element.node);check=function(){if(document.readyState==="complete"){element.style("position:absolute;");setTimeout(function(){element.style("position:relative;");element.parent.removeChild(element.node.parentNode);element.node.parentNode.removeChild(element.node);element.parent.appendChild(element.node)},5)}else{setTimeout(check,10)}};check();return this};SVG.Shape=function(element){this.constructor.call(this,element)};SVG.Shape.prototype=new SVG.Element;SVG.Rect=function(){this.constructor.call(this,SVG.create("rect"))};SVG.Rect.prototype=new SVG.Shape;SVG.Ellipse=function(){this.constructor.call(this,SVG.create("ellipse"))};SVG.Ellipse.prototype=new SVG.Shape;SVG.extend(SVG.Ellipse,{x:function(x){return x==null?this.cx()-this.attr("rx"):this.cx(x+this.attr("rx"))},y:function(y){return y==null?this.cy()-this.attr("ry"):this.cy(y+this.attr("ry"))},cx:function(x){return x==null?this.attr("cx"):this.attr("cx",x/this.trans.scaleX)},cy:function(y){return y==null?this.attr("cy"):this.attr("cy",y/this.trans.scaleY)},size:function(width,height){return this.attr({rx:width/2,ry:height/2})}});SVG.Line=function(){this.constructor.call(this,SVG.create("line"))};SVG.Line.prototype=new SVG.Shape;SVG.extend(SVG.Line,{x:function(x){var b=this.bbox();return x==null?b.x:this.attr({x1:this.attr("x1")-b.x+x,x2:this.attr("x2")-b.x+x})},y:function(y){var b=this.bbox();return y==null?b.y:this.attr({y1:this.attr("y1")-b.y+y,y2:this.attr("y2")-b.y+y})},cx:function(x){var half=this.bbox().width/2;return x==null?this.x()+half:this.x(x-half)},cy:function(y){var half=this.bbox().height/2;return y==null?this.y()+half:this.y(y-half)},size:function(width,height){var b=this.bbox();return this.attr(this.attr("x1")<this.attr("x2")?"x2":"x1",b.x+width).attr(this.attr("y1")<this.attr("y2")?"y2":"y1",b.y+height)},plot:function(x1,y1,x2,y2){return this.attr({x1:x1,y1:y1,x2:x2,y2:y2})}});SVG.Polyline=function(unbiased){this.constructor.call(this,SVG.create("polyline"));this.unbiased=unbiased};SVG.Polyline.prototype=new SVG.Shape;SVG.Polygon=function(unbiased){this.constructor.call(this,SVG.create("polygon"));this.unbiased=unbiased};SVG.Polygon.prototype=new SVG.Shape;SVG.extend(SVG.Polyline,SVG.Polygon,{_plot:function(p){if(Array.isArray(p)){var i,l,points=[];for(i=0,l=p.length;i<l;i++)points.push(p[i].join(","));p=points.length==0?points.join(" "):"0,0"}return this.attr("points",p||"0,0")}});SVG.Path=function(unbiased){this.constructor.call(this,SVG.create("path"));this.unbiased=unbiased};SVG.Path.prototype=new SVG.Shape;SVG.extend(SVG.Path,{_plot:function(data){return this.attr("d",data||"M0,0")}});SVG.extend(SVG.Polyline,SVG.Polygon,SVG.Path,{x:function(x){return x==null?this.bbox().x:this.transform("x",x)},y:function(y){return y==null?this.bbox().y:this.transform("y",y)},size:function(width,height){var scale=width/this._offset.width;return this.transform({scaleX:scale,scaleY:height!=null?height/this._offset.height:scale})},plot:function(data){var x=this.trans.scaleX,y=this.trans.scaleY;this._plot(data);this._offset=this.transform({scaleX:1,scaleY:1}).bbox();if(this.unbiased){this._offset.x=this._offset.y=0}else{this._offset.x-=this.trans.x;this._offset.y-=this.trans.y}return this.transform({scaleX:x,scaleY:y})}});SVG.Image=function(){this.constructor.call(this,SVG.create("image"))};SVG.Image.prototype=new SVG.Shape;SVG.extend(SVG.Image,{load:function(url){return url?this.attr("xlink:href",this.src=url,SVG.xlink):this}});var _styleAttr="size family weight stretch variant style".split(" ");SVG.Text=function(){this.constructor.call(this,SVG.create("text"));this.styles={};this._leading=1.2};SVG.Text.prototype=new SVG.Shape;SVG.extend(SVG.Text,{x:function(x,a){if(x==null)return a?this.attr("x"):this.bbox().x;if(!a){a=this.style("text-anchor");x=a=="start"?x:a=="end"?x+this.bbox().width:x+this.bbox().width/2}return this.attr("x",x)},cx:function(x,a){return x==null?this.bbox().cx:this.x(x-this.bbox().width/2)},cy:function(y,a){return y==null?this.bbox().cy:this.y(a?y:y-this.bbox().height/2)},move:function(x,y,a){return this.x(x,a).y(y)},center:function(x,y,a){return this.cx(x,a).cy(y,a)},text:function(text){if(text==null)return this.content;this.clear();this.content=SVG.regex.isBlank.test(text)?"text":text;var i,il,lines=text.split("\n");for(i=0,il=lines.length;i<il;i++)this.tspan(lines[i]);return this},tspan:function(text){var tspan=(new SVG.TSpan).text(text);this.node.appendChild(tspan.node);this.lines.push(tspan);return tspan.attr("style",this.style())},size:function(size){return this.attr("font-size",size)},leading:function(value){if(value==null)return this._leading;this._leading=value;return this.rebuild()},rebuild:function(){var i,il,size=parseInt(this.styles["font-size"]);for(i=0,il=this.lines.length;i<il;i++)this.lines[i].attr({dy:size*this._leading-(i==0?size*.276666666:0),x:this.attr("x")||0,style:this.style()});return this},clear:function(){while(this.node.hasChildNodes())this.node.removeChild(this.node.lastChild);this.lines=[];return this}});SVG.TSpan=function(){this.constructor.call(this,SVG.create("tspan"))};SVG.TSpan.prototype=new SVG.Shape;SVG.extend(SVG.TSpan,{text:function(text){this.node.appendChild(document.createTextNode(text));return this}});SVG.Nested=function(){this.constructor.call(this,SVG.create("svg"));this.style("overflow","visible")};SVG.Nested.prototype=new SVG.Container;SVG._stroke=["color","width","opacity","linecap","linejoin","miterlimit","dasharray","dashoffset"];SVG._fill=["color","opacity","rule"];var _colorPrefix=function(type,attr){return attr=="color"?type:type+"-"+attr};["fill","stroke"].forEach(function(method){var extension={};extension[method]=function(o){var indexOf;if(typeof o=="string"||SVG.Color.isRgb(o)||SVG.Color.isHsb(o))this.attr(method,o);else for(index=SVG["_"+method].length-1;index>=0;index--)if(o[SVG["_"+method][index]]!=null)this.attr(_colorPrefix(method,SVG["_"+method][index]),o[SVG["_"+method][index]]);return this};SVG.extend(SVG.Shape,SVG.FX,extension)});SVG.extend(SVG.Element,SVG.FX,{rotate:function(deg,x,y){return this.transform({rotation:deg||0,cx:x,cy:y})},skew:function(x,y){return this.transform({skewX:x||0,skewY:y||0})},scale:function(x,y){return this.transform({scaleX:x,scaleY:y==null?x:y})},matrix:function(m){return this.transform({matrix:m})},opacity:function(value){return this.attr("opacity",value)}});if(SVG.Text){SVG.extend(SVG.Text,SVG.FX,{font:function(o){for(var key in o)key=="anchor"?this.attr("text-anchor",o[key]):_styleAttr.indexOf(key)>-1?this.attr("font-"+key,o[key]):this.attr(key,o[key]);return this}})}}).call(this);