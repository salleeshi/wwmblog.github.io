var lastMailContent="";
$(function(){function p(a){a.stopPropagation()}function q(){for(var a=$("body").width(),b=a/2,f=b,d=window.pageXOffset,c=0;3>c;++c){var g=d<f?-8:0;d<f+b&&(g=8*((d-f)/b-1));e[c].css("bottom",g+"px");f+=a}e[3].toggle(0<d);e[4].toggle(0<d);d>=3*a?(e[5].hide(),j.focus()):"none"==e[5].css("display")&&(e[5].show(),j.blur())}function r(a){return/[\w\d_\.\-]+@([\w\d_\-]+\.)+[\w\d]{2,4}/.test(a)}function s(a){a.css({backgroundPosition:"0 0"}).animate({backgroundPosition:"-96px 0"},500,"linear",function(){s(a)})}
function x(){var a=document.getElementsByTagName("body")[0],b=document.createElement("div"),f=document.createElement("span");b.appendChild(f);b.style.fontFamily=f.style.fontFamily="Arial";f.style.fontSize="72px";f.innerHTML="mmmmmmmmmmlil";a.appendChild(b);var d=f.offsetWidth,c=f.offsetHeight;f.style.fontFamily="Microsoft Yahei";var g=f.offsetWidth,f=f.offsetHeight;a.removeChild(b);return g!=d||f!=c}function y(a){a.children().stop(!0,!0).each(function(){$(this).children().stop(!0,!0)});return a}function m(a){var b=
y(a).outerWidth()-Number(a.attr("lend")),f=Number(a.attr("rend")),f=(b-f)/Number(a.attr("totalLv")),d=a.children(),c=d.size()-1,g=0,e=!0==a.data("inited");for(e||a.data("inited",!0);0<=c;--c){var k=$(d[c]);e||k.attr("prefWidth",k.outerWidth());var h=Math.round(k.attr("level")*f),j=g+4,g=g+h,h=b-g;k.css("right",h).data({contentLeft:j,thisRight:h}).children().css({left:j,position:"absolute"})}a.data("currentWidth",a.outerWidth())}function t(){$(this).parent().children().each(function(){var a=$(this).stop(!0,
!1);a.animate({right:a.data("thisRight")+"px"},200).children().animate({left:a.data("contentLeft")+"px"},200)})}function u(){function a(a){return f-parseInt(a.css("left"))-a.data("thisRight")-a.data("contentLeft")-10}var b=$(this),f=b.parent().outerWidth(),d=b.attr("prefWidth")-a(b);if(!(0>=d)){for(var c=b.prev(),g=0,e=[],k=[];0!=c.size()&&g<d;){e.push(c);var h=a(c)-32;h+g>d&&(h=d-g);g+=h;k.push(h);c=c.prev()}d-=g;b.stop(!0,!1).animate({right:b.data("thisRight")-g+"px"},200);if(0!=g){h=g;for(i=0;i<
e.length;++i)c=e[i],c.children().stop(!0,!1).animate({left:c.data("contentLeft")+h+"px"},200),i!=e.length-1&&(h-=k[i],c.stop(!0,!1).animate({right:c.data("thisRight")-h+"px"},200))}if(0!=d){e=0;for(c=b.next();0!=c.size();)e+=46,c=c.next();c=b.children().position().left-e;if(!(0>=c)){d>c&&(d=c);b.children().stop(!0,!1).animate({left:b.data("contentLeft")-d+"px"},200);for(c=b.next();0!=c.size()&&0<d;)b=c.stop(!0,!1).animate({right:c.data("thisRight")+d+"px"},200),c=c.next(),0!=c.size()&&(h=a(b)-32,
h>d?d=0:(d-=h,b.children().stop(!0,!1).animate({left:b.data("contentLeft")-d+"px"},200)))}}}}var e=[$("#barSkill"),$("#barWork"),$("#barContact"),$("#btnSpace").hide(),$("#btnLeft").hide(),$("#btnRight")];e[3].click(function(){$.scrollTo({top:0,left:0},500)});e[4].click(function(){var a=$("body").width(),b=Math.floor(window.pageXOffset/a);0==window.pageXOffset%a&&0<b&&--b;$.scrollTo({top:0,left:b*a},300)});e[5].click(function(){var a=$("body").width(),b=Math.ceil(window.pageXOffset/a);0==window.pageXOffset%
a&&3>b&&++b;$.scrollTo({top:0,left:b*a},300)});$("#nav a").each(function(){""!=this.name&&$(this).click(function(a){$.scrollTo("#"+this.name,600);a.preventDefault()})});$("body").mousewheel(function(a,b){window.scrollBy(30*-b,0);a.preventDefault()}).keyup(function(a){var b=a.keyCode|a.which;32==b?e[3].click():37==b?e[4].click():39==b&&e[5].click();a.preventDefault()});var j=$("#content"),n=$("#mail"),l=$("#notification");j.add("#fancyInput").mousewheel(p).keyup(p);$(window).scroll(q).resize(q);$("#sendme").click(function(){if(""==
j.val()||j.val()==j.attr("placeholder"))l.html("\u4f60\u4ec0\u4e48\u90fd\u8fd8\u6ca1\u5199\u5462~~");else if(r(n.val()))if(lastMailContent==j.val())l.html("\u4f60\u5df2\u7ecf\u53d1\u8fc7\u4e00\u6837\u7684\u6d88\u606f\u4e86\u3002");else{lastMailContent=j.val();l.html("");s(e[2]);l.html("Sending...");$.ajax({type:"POST",url:"http://lmmailserver.appspot.com",dataType:"jsonp",jsonp:"jsonp",data:{email:n.val(),content:j.val()},success:function(b){"success"==b.result?(l.html("\u53d1\u9001\u6210\u529f\u3002\u6211\u4f1a\u5c3d\u5feb\u56de\u590d\u4f60\u7684\u3002"),
$("#stampd").show().css({left:"2px",top:"87px",width:"147px",height:"91px"}).animate({left:"7px",top:"92px",width:"137px",height:"81"},100)):a()},error:a,complete:function(){e[2].stop()}});var a=function(){$("#stampd").hide();l.html("Oops\uff0c\u51fa\u9519\u4e86\u3002\u4e0d\u5982\u76f4\u63a5\u53d1\u90ae\u4ef6\u7ed9\u6211\u5427: liangmorr@gmail.com")}}else l.html("Email\u4e0d\u6b63\u786e\u5427~~");return!1});j.bind("textchange",function(){l.html("");$("#stampd").hide()});n.bind("textchange",function(){r($(this).val())?
$("#sendme").removeAttr("disabled"):$("#sendme").attr("disabled","disabled")}).keydown(function(a){if(13==a.keyCode|13==a.which)return $("#sendme").click(),a.preventDefault(),!1}).trigger("textchange");$.support.placeholder||j.add(n).focus(function(){var a=$(this);""!=a.attr("placeholder")&&a.val()==a.attr("placeholder")&&a.val("")}).blur(function(){var a=$(this);""!=a.attr("placeholder")&&""==a.val()&&a.val(a.attr("placeholder"))}).blur();$("#worklist .overlay").css("opacity",0);$("#worklist li a").append("<div class='s2'></div>");
$("#worklist li").hover(function(){var a=$(this).stop().animate({top:"-5px"},250).children(".triangle").hide().nextAll(".overlay").stop().animate({opacity:1},250).next();a.animate({left:(111-a.outerWidth())/2+"px"},200).next().show().animate({left:"38px",top:"30px",width:"34px",height:"34px",opacity:"0.7"},200)},function(){$(this).animate({top:"0"},250).children(".overlay").animate({opacity:0},250).next().animate({left:"-10px"},200,"linear",function(){$(this).siblings(".triangle").show()}).next().css({left:"45px",
top:"35px",width:"24px",height:"24px",opacity:"0"}).hide()});$("#logoAlt").css("opacity","0").hover(function(){$(this).stop().animate({opacity:"1"},200)},function(){$(this).stop().animate({opacity:"0"},200)});var o=$("#socialExpand"),v=o.find("a");$("#social #showSocial").toggle(function(){$(this).rotate({animateTo:90});o.stop().slideDown(200,function(){v.each(function(a){$(this).delay(50*a).animate({opacity:1},250)})})},function(){$(this).rotate({animateTo:0});v.animate({opacity:0},100,function(){o.slideUp(200)})}).click();
$(".ttTarget").each(function(){var a=$(this),b=a.attr("title");if(""!=b){a.attr("title","");var e=a.hasClass("ttFar")?20:10,d=null,c=!1,g="-=",j="+=",k=$("<div class='tooltip' style='opacity:0;'>"+b+"</div>").appendTo("body"),h=!a.hasClass("ttBottom"),b=a;a.hasClass("lf")&&k.addClass("lf");h?(k.append("<div class='arrow'></div>"),b=a.add(k)):(g="+=",j="-=",k.addClass("ttBottom"),k.prepend("<div class='arrow'></div>"));b.hover(function(){d&&clearTimeout(d);if(!c){c=!0;var b=a.offset(),j=b.left-window.pageXOffset+
a.outerWidth()/2-k.outerWidth()/2,b=b.top-window.pageYOffset+(h?-k.outerHeight()-10:a.outerHeight()+10);k.css({left:j+"px",top:b+"px",display:"block"}).stop().animate({top:g+e+"px",opacity:1},250,"swing")}},function(){d&&clearTimeout(d);d=setTimeout(function(){hideDelayTimer=null;c=!1;k.stop(!0,!0).animate({top:j+e+"px",opacity:0},250,"swing",function(){k.css("display","none")})},200)})}});var w=navigator.platform.toLowerCase();(-1==w.indexOf("windows")||-1==w.indexOf("win32"))&&x()&&$("#intro").add("#nav").css("font-weight",
"normal");m($("#pro"));m($("#basic"));window.onresize=function(){var a=$("#pro");a.outerWidth()!=a.data("currentWidth")&&(m(a),m($("#basic")))};$("#pro").children().hover(u,t);$("#basic").children().hover(u,t)});
